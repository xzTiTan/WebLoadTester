<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:WebLoadTester.Presentation.ViewModels"
        x:Class="WebLoadTester.Presentation.Views.SettingsWindow"
        x:DataType="vm:SettingsWindowViewModel"
        Title="Настройки"
        Width="720" Height="640"
        WindowStartupLocation="CenterOwner">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16" Spacing="16">
            <Border Classes="section">
                <StackPanel Spacing="8">
                    <TextBlock Text="Storage paths" Classes="section-title" />

                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Data directory" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding DataDirectory, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="200,*" Margin="0,0,0,8">
                        <StackPanel Grid.Column="1" Classes="section-actions">
                            <Button Content="Выбрать" Command="{Binding BrowseDataDirectoryCommand}" />
                            <Button Content="Открыть" Command="{Binding OpenDataDirectoryCommand}" />
                            <Button Content="Копировать" Command="{Binding CopyDataDirectoryCommand}" />
                        </StackPanel>
                    </Grid>

                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Runs root" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding RunsDirectory, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="200,*" Margin="0,0,0,8">
                        <StackPanel Grid.Column="1" Classes="section-actions">
                            <Button Content="Выбрать" Command="{Binding BrowseRunsDirectoryCommand}" />
                            <Button Content="Открыть" Command="{Binding OpenRunsDirectoryCommand}" />
                            <Button Content="Копировать" Command="{Binding CopyRunsDirectoryCommand}" />
                        </StackPanel>
                    </Grid>

                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Profiles directory" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding ProfilesDirectory, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="200,*" Margin="0,0,0,8">
                        <StackPanel Grid.Column="1" Classes="section-actions">
                            <Button Content="Выбрать" Command="{Binding BrowseProfilesDirectoryCommand}" />
                            <Button Content="Открыть" Command="{Binding OpenProfilesDirectoryCommand}" />
                            <Button Content="Копировать" Command="{Binding CopyProfilesDirectoryCommand}" />
                        </StackPanel>
                    </Grid>

                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Database path" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding DatabasePath}" IsReadOnly="True" />
                    </Grid>
                    <Grid ColumnDefinitions="200,*">
                        <StackPanel Grid.Column="1" Classes="section-actions">
                            <Button Content="Открыть" Command="{Binding OpenDatabasePathCommand}" />
                            <Button Content="Копировать" Command="{Binding CopyDatabasePathCommand}" />
                        </StackPanel>
                    </Grid>

                    <TextBlock Text="Артефакты прогонов сохраняются в runs/{RunId}/ (report.json, report.html, screenshots/, logs/)." TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <Border Classes="section">
                <StackPanel Spacing="8">
                    <TextBlock Text="Telegram" Classes="section-title" />
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Token" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding TelegramSettings.BotToken, Mode=TwoWay}" PasswordChar="*" />
                    </Grid>
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="ChatId" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding TelegramSettings.ChatId, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Уведомления" Classes="field-label" />
                        <CheckBox Classes="field-control" Content="Включено" IsChecked="{Binding TelegramSettings.Enabled, Mode=TwoWay}" />
                    </Grid>
                    <CheckBox Content="Уведомлять о старте" IsChecked="{Binding TelegramSettings.NotifyOnStart, Mode=TwoWay}" />
                    <CheckBox Content="Уведомлять о завершении" IsChecked="{Binding TelegramSettings.NotifyOnFinish, Mode=TwoWay}" />
                    <CheckBox Content="Уведомлять об ошибке" IsChecked="{Binding TelegramSettings.NotifyOnError, Mode=TwoWay}" />
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Режим прогресса" Classes="field-label" />
                        <ComboBox Classes="field-control"
                                  ItemsSource="{Binding TelegramSettings.ProgressModes}"
                                  SelectedItem="{Binding TelegramSettings.ProgressMode, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Прогресс каждые N" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding TelegramSettings.ProgressEveryN, Mode=TwoWay}" />
                    </Grid>
                    <Grid ColumnDefinitions="{DynamicResource LabelColumnWidth},*" Classes="field-row">
                        <TextBlock Text="Ограничение частоты (сек)" Classes="field-label" />
                        <TextBox Classes="field-control" Text="{Binding TelegramSettings.RateLimitSeconds, Mode=TwoWay}" />
                    </Grid>
                </StackPanel>
            </Border>

            <StackPanel Classes="section-actions">
                <Button Content="Сохранить" Command="{Binding SaveCommand}" />
            </StackPanel>
            <TextBlock Text="{Binding StatusMessage}" Classes="status-line" />
        </StackPanel>
    </ScrollViewer>
</Window>
