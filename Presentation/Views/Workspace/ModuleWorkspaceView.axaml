<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:WebLoadTester.Presentation.ViewModels.Workspace"
             xmlns:views="clr-namespace:WebLoadTester.Presentation.Views.Workspace"
             x:Class="WebLoadTester.Presentation.Views.Workspace.ModuleWorkspaceView"
             x:DataType="vm:ModuleFamilyViewModel">
    <Grid ColumnDefinitions="Auto,5,*,5,Auto" RowDefinitions="*" ColumnSpacing="8">
        <Border Grid.Column="0" Width="{Binding Workspace.LeftNavWidth}" Padding="8">
            <StackPanel Spacing="8" IsEnabled="{Binding Workspace.IsIdle}">
                <TextBox Watermark="Поиск модуля" Text="{Binding ModuleSearchText, Mode=TwoWay}" />
                <ListBox ItemsSource="{Binding Modules}" SelectedItem="{Binding SelectedModule, Mode=TwoWay}">
                    <ListBox.ItemTemplate>
                        <DataTemplate x:DataType="vm:ModuleDescriptorVm">
                            <StackPanel Spacing="2">
                                <TextBlock Text="{Binding DisplayName}" />
                                <TextBlock Text="{Binding ModuleId}" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Border>

        <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" ResizeDirection="Columns" ResizeBehavior="PreviousAndNext" />

        <Border Grid.Column="2" Padding="8">
            <ScrollViewer x:Name="WorkspaceScrollViewer" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Spacing="12">
                    <WrapPanel>
                        <Button Content="Details" Command="{Binding Workspace.ToggleDetailsCommand}" />
                    </WrapPanel>

                    <TextBlock Text="Выберите модуль слева"
                               IsVisible="{Binding Workspace.HasModuleSelected, Converter={StaticResource BooleanNotConverter}}" />

                    <StackPanel IsVisible="{Binding Workspace.HasModuleSelected}" Spacing="12">
                        <views:RunControlView DataContext="{Binding Workspace.RunControl}" />

                        <Border IsEnabled="{Binding Workspace.IsIdle}">
                            <views:TestCaseView DataContext="{Binding Workspace.TestCase}" />
                        </Border>

                        <Border IsEnabled="{Binding Workspace.IsIdle}">
                            <views:RunProfileView DataContext="{Binding Workspace.RunProfile}" />
                        </Border>

                        <GroupBox Header="Module Settings" IsEnabled="{Binding Workspace.IsIdle}">
                            <StackPanel Margin="8" Spacing="8">
                                <ContentControl Content="{Binding Workspace.ModuleSettingsVm}" />
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" ResizeDirection="Columns" ResizeBehavior="PreviousAndNext" />

        <Border Grid.Column="4"
                Width="{Binding Workspace.DetailsWidth}"
                Padding="8"
                IsVisible="{Binding Workspace.IsDetailsVisible}">
            <views:DetailsPaneView DataContext="{Binding Workspace.Details}" />
        </Border>
    </Grid>
</UserControl>
