<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:WebLoadTester.Presentation.ViewModels.SettingsViewModels"
             xmlns:rowVm="clr-namespace:WebLoadTester.Presentation.ViewModels.SettingsViewModels.UiScenario"
             xmlns:controls="clr-namespace:WebLoadTester.Presentation.Views.Controls"
             xmlns:domain="clr-namespace:WebLoadTester.Modules.UiScenario"
             x:Class="WebLoadTester.Presentation.Views.SettingsViews.UiScenarioSettingsView"
             x:DataType="vm:UiScenarioSettingsViewModel"
             x:Name="Root">
    <UserControl.DataTemplates>
        <DataTemplate DataType="{x:Type rowVm:UiStepRowViewModel}">
            <StackPanel Spacing="2" Margin="0,0,0,6">
                <Grid ColumnDefinitions="140,2*,2*,96" ColumnSpacing="6">
                    <ComboBox Grid.Column="0"
                              ItemsSource="{Binding DataContext.ActionOptions, ElementName=Root}"
                              SelectedItem="{Binding Action, Mode=TwoWay}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate x:DataType="domain:UiStepAction">
                                <TextBlock Text="{Binding ., Converter={StaticResource UiScenarioActionDisplayConverter}}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                    <TextBox Grid.Column="1"
                             Text="{Binding Selector, Mode=TwoWay}"
                             IsEnabled="{Binding IsSelectorEnabled}"
                             Watermark="{Binding SelectorWatermark}" />

                    <TextBox Grid.Column="2"
                             Text="{Binding Value, Mode=TwoWay}"
                             IsEnabled="{Binding IsValueEnabled}"
                             Watermark="{Binding ValueWatermark}" />

                    <NumericUpDown Grid.Column="3"
                                   Minimum="0"
                                   Maximum="600000"
                                   Increment="100"
                                   Value="{Binding DelayMs, Mode=TwoWay}"
                                   IsEnabled="{Binding IsDelayMsEnabled}" />
                </Grid>

                <TextBlock Text="{Binding RowErrorText}" IsVisible="{Binding HasRowError}" TextWrapping="Wrap" Classes="error" />
            </StackPanel>
        </DataTemplate>
    </UserControl.DataTemplates>

    <StackPanel Spacing="16">
        <Border Classes="section">
            <StackPanel Spacing="12">
                <TextBlock Text="Параметры сценария" Classes="section-title" />
                <Grid ColumnDefinitions="{StaticResource FieldRowColumns}" Classes="field-row">
                    <TextBlock Text="Стартовый URL" Classes="field-label" />
                    <TextBox Classes="field-control"
                             Watermark="Можно оставить пустым, если первый шаг — Переход"
                             Text="{Binding TargetUrl, Mode=TwoWay}" />
                </Grid>
                <Grid ColumnDefinitions="{StaticResource FieldRowColumns}" Classes="field-row">
                    <TextBlock Text="Таймаут ожиданий, мс" Classes="field-label" />
                    <NumericUpDown Classes="field-control"
                                   Minimum="1000"
                                   Maximum="120000"
                                   Increment="500"
                                   Value="{Binding TimeoutMs, Mode=TwoWay}" />
                </Grid>
            </StackPanel>
        </Border>

        <Border Classes="section">
            <StackPanel Spacing="12">
                <TextBlock Text="Шаги" Classes="section-title" />
                <controls:RowListEditorView DataContext="{Binding StepsEditor}" />
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>
