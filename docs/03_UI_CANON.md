# UI канон и поведения — WebLoadTester

**Версия:** v1.9 11.02.2026

**Назначение:** описывает интерфейс и поведение приложения на уровне, достаточном для реализации и для включения в ВКР (без Figma).

## 1. Главное окно: композиция
Состав (сверху вниз):
1) **App Header** — статус БД/Telegram, быстрые действия (Настройки, открыть папку прогонов).
2) **Tab Strip** — 4 вкладки верхнего уровня.
3) **Tab Content** — рабочая область текущей вкладки.
4) **Log Drawer** — общий нижний выдвижной блок (скрыт по умолчанию).

Вкладки (обязательные):
- UI тестирование
- HTTP тестирование
- Сеть и безопасность
- Прогоны

## 2. Канон layout для вкладок модулей (UI/HTTP/NET)
Во вкладках семейств (UI/HTTP/NET) применяем один шаблон «Module Workspace».

### 2.1 Три закреплённых ряда сверху (Pinned rows)
1) **Run Control Row**
   - Кнопки: Старт / Перезапуск / Стоп / Отмена (доступность зависит от `IsRunning`).
   - Строки: Статус, Прогресс, Стадия.

2) **Module Selection Row**
   - Выбор модуля **в строку, без поиска** (Radio/ToggleButtons).

3) **Module Info Row**
   - `DisplayName` + `Description` выбранного модуля.

Далее идёт **единственный ScrollViewer** для остального контента (чтобы не было вложенных скроллов).

### 2.2 Секции внутри ScrollViewer
В порядке сверху вниз:
1) **Конфигурация** (Test Library): выбор теста/версии, загрузка/сохранение.
2) **Настройки модуля** (SettingsView для конкретного модуля).
3) **Параметры запуска** (RunProfile) — отдельная секция.
4) **Последний отчёт** (если есть) — краткие агрегаты + ошибки.

## 3. Лог: общий нижний drawer
- По умолчанию **свернут**.
- В развернутом виде:
  - чекбокс **Автоскролл** (по умолчанию включён)
  - чекбокс **Только ошибки** (достаточно для MVP)
  - кнопки: Очистить / Копировать
  - список строк лога (с ограничением размера/виртуализацией при необходимости)

**Важно:** лог отражает только текущий запуск; при новом старте очищается.

## 4. UX-ограничения (как критерии качества)
1) Запрещено накладывать TextBlock поверх TextBox для плейсхолдера — используем `Watermark`.
2) Колонки/блоки не должны быть «узкими» (текст не превращается в вертикальную «колбасу»).
3) Ошибки валидации показываем **до старта** и без падений.

## 5. Валидация и сообщения пользователю
- До запуска выполняется `_orchestrator.Validate(...)`.
- При ошибках:
  - `StatusText = "Статус: ошибка валидации"`
  - `ModuleConfig.StatusMessage = "Заполните обязательные поля: ..."`
  - запись `Warn` в лог.

## 6. A1 UI сценарий: шаги (минималистично и без лишних полей)
Правило MVP:
- `Selector` **обязателен**.
- Если `Text` заполнен → выполняем **Fill**.
- Если `Text` пустой → выполняем **Click**.

Рекомендованная форма шага (UI):
- Поля: `Selector` (TextBox, required), `Text` (TextBox, optional), `TimeoutMs` (optional, с дефолтом).
- Кнопки: Добавить шаг / Удалить шаг / Вверх / Вниз.

Отображение списка шагов:
- компактные карточки, без наложения текста, с ясным типом действия (Click/Fill) вычисляемым из `Text`.

## 7. Вкладка «Прогоны»
- Таблица прогонов: RunId, модуль, статус, время, длительность, количество ошибок.
- Панель деталей: ссылки на артефакты (`report.json`, `report.html` если есть, `run.log`, screenshots) + кнопка «Открыть папку».
- Кнопка «Повторить» — повторяет прогон на основании сохранённого профиля + конфигурации.

## 8. Окно «Настройки»
Секции:
- Storage: `DataDirectory`, `RunsDirectory`.
- Telegram: token/chatId и режимы уведомлений (опционально).

Ошибка Telegram не должна приводить к падению приложения.
