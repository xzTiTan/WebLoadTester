Отчёты, артефакты, Telegram: форматы, логика и ожидаемые результаты
Версия: v1.1 24.01.2026

1) Принцип “каждый прогон оставляет след”
После каждого запуска должны быть:
- запись TestRun в БД (RunId),
- report.json (всегда),
- логи и прочие артефакты (при наличии),
- report.html (опционально),
- Telegram статус (опционально).

2) Файловая структура прогонов
/runs/{RunId}/
  report.json
  report.html (опционально)
  /screenshots/...
  /logs/run.log
  (прочие артефакты)

3) JSON отчёт — минимально достаточная структура
3.1 run
- runId, startedAt, finishedAt, status
- moduleType, moduleNameRu
- testName, testCaseId, testCaseVersion

3.2 environment (для воспроизводимости)
- os
- appVersion
- machineName (если доступно)

3.3 profile (snapshot фактически использованных параметров)
- parallelism, mode (iterations/duration), iterations/durationSeconds
- timeouts
- headless, screenshotsPolicy
- htmlReportEnabled, telegramEnabled
- preflightEnabled (если применялось)

3.4 summary
- totalDurationMs
- totalItems, failedItems
- ключевые метрики (avg; p95/p99 при наличии достаточного N)

3.5 details
- список элементов проверки (Step/Endpoint/Asset/NetCheck/…)
- каждый элемент: key, status, durationMs, errorMessage, extra (опционально)

3.6 artifacts
- список: type, relativePath

4) HTML отчёт (опционально)
Назначение: удобное чтение руководителем/заказчиком.
Содержимое:
- краткая сводка (статус, длительность, ошибки, ключевые метрики)
- список проблемных элементов
- ссылки на артефакты

5) Логи
- UI показывает live-лог.
- После завершения лог сохраняется в /runs/{RunId}/logs/run.log.
- Лог должен фиксировать стадии: validate → preflight → running → saving/reporting → done.

6) Telegram уведомление
- формат: тест + модуль + итог + длительность + ошибки + ключевая метрика (если есть) + RunId
- ошибка Telegram не меняет статус прогона; фиксируется как отдельное событие в БД/логах.
