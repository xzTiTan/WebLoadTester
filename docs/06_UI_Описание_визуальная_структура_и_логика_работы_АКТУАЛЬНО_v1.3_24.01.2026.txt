UI WebLoadTester — визуальная структура, элементы управления, логика работы и требования к адаптивности
Версия: v1.3 24.01.2026

1. Назначение UI и целевые роли
UI предназначен для разных ролей ИТ-команды, при этом интерфейс остаётся единым:
- Эксплуатация/DevOps/SRE: диагностика, доступность, история прогонов, повтор запусков.
- QA/автоматизатор: сценарии и проверки, воспроизводимость.
- Разработчик: просмотр деталей, логов, артефактов, ускорение локализации.
- Руководитель/менеджер: итоговый HTML-отчёт и краткий статус.

2. Базовые требования к компоновке и адаптивности (фиксируем)
2.1 Вертикальная последовательная компоновка
Все секции на экране модуля располагаются сверху вниз. Ничего не “прибивается” к низу окна.

2.2 Отсутствие наложений
При изменении размера окна элементы не перекрываются. При нехватке места включается вертикальная прокрутка.

2.3 Техническая реализация (Avalonia)
Каждая вкладка: ScrollViewer (VerticalScrollBarVisibility=Auto) → вертикальный контейнер секций.
Допускается MaxHeight для таблиц/логов с внутренним скроллом.

3. Главное окно (верхний уровень)
3.1 Верхняя панель (Toolbar/Header)
- Кнопка “Настройки”.
- Индикатор “БД: OK/Ошибка”.
- Индикатор “Telegram: настроен/не настроен”.
- Кнопка “Папка прогонов”.
Требование: при недостатке ширины элементы переносятся (wrap), без наложений.

3.2 TabControl (4 вкладки)
- UI тестирование
- HTTP тестирование
- Сеть и безопасность
- Прогоны

4. Единый паттерн экрана модуля (A1..C4) — секции сверху вниз
Секция 1 — Выбор модуля
- ComboBox/ListBox модулей в пределах текущего семейства.
- Короткое описание модуля (1–2 предложения).

Секция 2 — Тесты (Test Library)
- ComboBox “Сохранённые тесты”.
- Кнопка “Загрузить” (применить выбранный тест к форме).
- Кнопка “Сохранить” (создать новую версию теста в БД).
- Поле “Название теста”.
- Поле “Описание” (опционально).
Правило: выбор в ComboBox не перезаписывает форму автоматически — только по кнопке “Загрузить”.

Секция 3 — Настройки модуля (динамические)
- Контент зависит от модуля: URL/списки/шаги/endpoint’ы/порты/чек-листы.
- Реализуется через ContentControl + DataTemplate по VM модуля.

Секция 4 — Профиль запуска (RunProfile)
- ComboBox “Профиль запуска” (шаблоны).
- Кнопка “Сохранить профиль” (создать новый шаблон).
- Parallelism: NumericUpDown.
- Режим: Iterations или Duration (выбор + поле).
- Таймауты: общий + (при необходимости) специфичные.
- UI-модули: Headless, ScreenshotsPolicy (Off/OnError/Always).
- Отчёты: JSON (всегда) + чекбокс HTML.
- Telegram: чекбокс “Отправить статус”.
- Preflight: чекбокс “Выполнить предпроверку перед запуском” (использует C4 логически).
Safe defaults и предупреждения:
- дефолт Parallelism=1–3; Duration=30–60 сек; Iterations=10–30.
- при “опасных” значениях (пример: Parallelism>10 или Duration>5 минут) UI показывает предупреждение (но не блокирует запуск).

Секция 5 — Управление запуском
- Start (доступна только при успешной валидации).
- Stop (мягкая остановка).
- Cancel (отмена).
- Статус стадии: Idle / Preflight / Running / Saving / Done.
- ProgressBar + текст прогресса.

Секция 6 — Итоговая сводка (сразу под кнопками)
- Итог: Success / Failed / Partial / Cancelled.
- Длительность.
- Количество ошибок / failedItems.
- Ключевые метрики (если применимо, p95/p99 — при наличии достаточных измерений).

Секция 7 — Детальные результаты
- Таблица/список элементов проверки (шаги/endpoint’ы/ассеты/порты/проверки).
- Допускается MaxHeight, чтобы таблица не занимала весь экран.

Секция 8 — Артефакты и действия
- “Открыть JSON отчёт”.
- “Открыть HTML отчёт” (если включено).
- “Открыть папку прогона”.
- Список скриншотов/логов (если есть).
- Telegram статус: Sent/Failed (ошибка не меняет итог прогона).

Секция 9 — Лог выполнения (Expander, раскрыт по умолчанию)
- Лог read-only.
- Фильтр “Только ошибки”.
- MaxHeight для удобства.

5. Специфика UI тестирования (A1–A3)
A1 UI-сценарии: стартовый URL + “доска шагов” (таблица шагов), кнопка “Добавить шаг”, перемещение (вверх/вниз), удаление, StepErrorPolicy.
A2 UI-снимки: список URL + ready-state, результаты и ссылки на скриншоты.
A3 UI-тайминги: список URL + повторы/длительность, таблица метрик.

6. Специфика HTTP тестирования (B1–B3)
B1 endpoint’ы: таблица method/url/expected, результаты code/latency/pass-fail.
B2 производительность: метрики + распределение кодов, предупреждения при высоких параметрах.
B3 ассеты: список ресурсов, причины fail.

7. Специфика “Сеть и безопасность” (C1–C4)
C1 DNS/TCP/TLS: host + порты (80/443 по умолчанию + добавление), результаты по уровням.
C2 монитор: аптайм и интервалы.
C3 baseline: чек-лист и рекомендации.
C4 preflight: Ready/Not Ready.

8. Вкладка “Прогоны” (единая история)
Цель: единый журнал прогонов всех модулей, быстрый поиск, просмотр деталей, повторный запуск.

8.1 Таблица прогонов (колонки)
- DateTime (начало)
- TestName
- ModuleName
- Status
- Duration
- FailedItems
- KeyMetrics (например avg/p95)
- RunId

8.2 Фильтры
- Модуль
- Статус
- Период (даты)
- Поиск по имени теста и RunId

8.3 Действия по выбранному прогону
- Открыть JSON / HTML
- Открыть папку прогона
- Копировать RunId
- Повторить запуск (используя: версию теста + snapshot профиля из TestRun)

Важно: повторный запуск всегда воспроизводим, потому что берёт версию теста и фактические параметры запуска.
