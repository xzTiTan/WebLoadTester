v3.4 16.02.2026

# CODEX_RULES_AND_CHANGELOG — правила для Codex/агентов и журнал изменений

## 1) Source of truth
- **Единый канон продукта (TO-BE):** `docs/INDEX.md`.
- Этот файл — **только** правила работы агента + журнал изменений.
- Код и текущий UI считаются **AS-IS** и приводятся к TO-BE через §16 «Дельта внедрения» в `docs/INDEX.md`.

## 2) Жёсткие инварианты (нельзя ломать)
1. **10 модулей / 3 семейства / 4 вкладки:** UI / HTTP / Сеть и безопасность / Прогоны.
2. **Хранилище:** SQLite + файловые артефакты в `runs/{RunId}/`.
3. **Отчёты:** `report.json` всегда; `report.html` опционально.
4. **Безопасность:** никаких атакующих действий (скан уязвимостей, bruteforce, эксплойты и т.п.).
5. **UI:** русский язык, ровная сетка, без наложений; MVVM без логики в Views.
6. **Отмена:** все долгие операции — `async` + `CancellationToken`. Stop ≠ Cancel (см. INDEX).

## 3) Порядок работы агента (обязательный)
1) Прочитать `docs/INDEX.md` целиком.  
2) Составить план изменений (коротко: какие файлы/классы/вьюхи трогаем).  
3) Реализовать изменения небольшими логическими шагами.  
4) После каждого шага — компиляция (`dotnet build`).  
5) По завершении — обновить этот файл (Changelog) + при необходимости обновить `docs/INDEX.md` (если менялась спецификация).

## 4) Правила изменений кода (guardrails)
- Не переименовывать публичные контракты/идентификаторы без причины.
- Не вводить новые технологии без необходимости (никаких новых DI-фреймворков, ORM и т.п. в MVP).
- Любые изменения структуры данных/отчётов — сначала фиксируются в `docs/INDEX.md`, затем код.
- Если в коде обнаружена “историческая” сущность (например, таблица есть, UI нет) — не удалять молча:
  - либо согласовать как “TO-BE”,
  - либо оформить в INDEX как дельту с планом миграции.

## 5) Обязательное версионирование документов
При любом изменении:
- обновить версии/дату в `README.md`, `AGENTS.md`, `docs/INDEX.md` (если спецификация менялась),
- добавить запись в Changelog ниже.

---

# Changelog


## v3.4 16.02.2026
- Prompt 5: доработан UI-family MVP (`ui.scenario`, `ui.snapshot`, `ui.timing`) под TO-BE из `docs/INDEX.md` (§1.1, §8.A).
- Playwright path перенесён в `{DataDirectory}/browsers`, установка Chromium теперь стримит вывод в лог и баннер показывается для всех UI-модулей.
- В UI-настройках модулей добавлены wrap-safe TableToolbar-панели (Add/Delete/Duplicate, plus Up/Down только для сценария).
- Обновлены версии `README.md` и `AGENTS.md` по правилу versioning.

## v3.3 16.02.2026
- Консолидация документации: `docs/INDEX.md` — единственный исходный документ.
- Оставлены только `docs/INDEX.md` и `docs/CODEX_RULES_AND_CHANGELOG.md` (прочие docs удалены/перенесены в историю git).
- Удалены устаревшие/кривые UI mockups и архивы (вариант A).
- Обновлены `README.md` и `AGENTS.md` под новый канон.
