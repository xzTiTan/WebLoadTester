# Канон проекта и требования — WebLoadTester

**Версия:** v1.8 11.02.2026  
**Статус:** *Источник истины* (если есть конфликт в других docs — правим Канон и приводим остальные файлы)

## 0. Состав документации (8 файлов)
- `README.md` — обзор + быстрый старт
- `01_CANON.md` — требования/границы/критерии (этот файл)
- `02_ARCHITECTURE_AND_DATA.md` — архитектура + данные + карта кода
- `03_UI_CANON.md` — UI канон (поведения/секции/валидация)
- `04_GLOSSARY.md` — единые термины
- `05_TEST_PLAN_AND_TRACEABILITY.md` — испытания + трассируемость
- `06_CODEX_RULES_AND_CHANGELOG.md` — guardrails + журнал изменений
- `07_VKR_DRAFT.md` — каркас пояснительной записки

## 1. Назначение
WebLoadTester — настольный программный комплекс для автоматизированного тестирования и диагностики веб-ресурсов по уровням: **DNS/TCP/TLS → HTTP → UI**.

Цель MVP: обеспечить **стабильную сборку** и **честный рабочий цикл** для всех 10 модулей: пользователь загружает/создаёт конфигурацию → валидирует поля → запускает → получает RunId, запись в SQLite и артефакты.

## 2. Неподвижные ограничения
1) **4 вкладки верхнего уровня:** UI тестирование / HTTP тестирование / Сеть и безопасность / Прогоны.
2) **10 модулей (3 семейства):** A1–A3, B1–B3, C1–C4 (см. §4).
3) **Только два режима нагрузки в ядре:** `Iterations` и `Duration`.
4) **SQLite обязателен** как кроссплатформенная реляционная БД.
5) **Артефакты прогона:** `runs/{RunId}/` и `report.json` всегда, `report.html` по флагу профиля.
6) **Telegram опционален:** ошибки Telegram не меняют итоговый статус прогона.
7) **Безопасность:** C3 — baseline без атакующих функций.

## 3. UX-решения (зафиксированы)
### 3.1 Конфигурации модулей
- Пользователь может **загрузить готовый конфиг** → все поля/галочки заполняются → остаётся нажать **Старт**.
- Сохранение возможно **только при заполненных обязательных полях**.
- Имя при сохранении формируется как: **`UserName_ModuleSuffix`**, без пробелов в `UserName`. Суффикс берётся из `ModuleCatalog`.

### 3.2 Параметры запуска
- «Параметры запуска» — отдельная секция (RunProfile): режим, параллельность, таймаут, HTML/Telegram/Preflight и UI-специфичные флаги.

### 3.3 Лог
- Лог — общий нижний **drawer**, по умолчанию скрыт.
- Автоскролл нужен; фильтр «только ошибки» достаточен для MVP.

### 3.4 Валидация перед стартом
- До перехода UI в состояние `IsRunning=true` выполняется:
  1) `_orchestrator.Validate(...)` по настройкам модуля + snapshot профиля
  2) `EnsureConfigForRunAsync()` (конфиг существует/сохранён)
- При ошибках запуск **не начинается**, пользователь видит понятный список обязательных полей.

## 4. Каталог модулей (10 модулей)
| Код | Id модуля | Семейство | Назначение (MVP) | Основные выходы |
|---|---|---|---|---|
| A1 | `ui.scenario` | UI | Сценарий шагов: navigate/click/fill/assert + скрин при ошибке/политике | результаты шагов, скриншоты, report.json |
| A2 | `ui.snapshot` | UI | Скриншоты списка URL (baseline) | screenshots + summary |
| A3 | `ui.timing` | UI | Замеры таймингов загрузки/навигации | метрики + summary |
| B1 | `http.functional` | HTTP | Функциональные проверки HTTP (статус/тело/заголовки) | pass/fail + детали |
| B2 | `http.performance` | HTTP | Управляемая нагрузка HTTP (iterations/duration) | latency/throughput + ошибки |
| B3 | `http.assets` | HTTP | Проверки статических ассетов (коды/типы/кэш) | список проблем |
| C1 | `net.diagnostics` | NET | DNS + TCP + TLS диагностика (без атак) | этапы + ошибки |
| C2 | `net.availability` | NET | Проверка доступности (probe) | ok/fail + время |
| C3 | `net.security` | NET | Security baseline (заголовки, TLS минимум) | findings |
| C4 | `net.preflight` | NET | Быстрый preflight (готовность перед запуском) | быстрый отчёт |

## 5. Критерии готовности MVP (Acceptance)
Система считается «MVP-готовой», если:
1) `dotnet build -c Release` проходит на Windows и Linux.
2) Для каждого модуля можно:
   - создать конфиг (или загрузить),
   - пройти валидацию обязательных полей,
   - запустить и получить `RunId`,
   - увидеть запись прогона на вкладке «Прогоны»,
   - открыть `runs/{RunId}/report.json`.
3) UI модули (A1–A3): при отсутствии Chromium показывают понятный баннер и не падают.
4) Telegram выключен по умолчанию; при ошибке отправки запуск не срывается.

## 6. Приоритет источников при конфликте
1) **Канон (этот файл) и UI-канон** (`03_UI_CANON.md`) — приоритет.
2) Затем архитектура/данные (`02_...`).
3) Затем испытания/трассируемость.

Любой конфликт фиксируется явно: где конфликтует, и какое решение принято.
